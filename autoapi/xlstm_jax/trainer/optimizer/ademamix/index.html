
<!DOCTYPE html>


<html lang="en" data-content_root="../../../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>xlstm_jax.trainer.optimizer.ademamix &#8212; xlstm-jax  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../../../../../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../../../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/custom.css?v=9df3ab08" />
  
  <!-- So that users can add custom icons -->
  <script src="../../../../../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../../../../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../../../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'autoapi/xlstm_jax/trainer/optimizer/ademamix/index';</script>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <link rel="next" title="xlstm_jax.trainer.optimizer.optimizer" href="../optimizer/index.html" />
    <link rel="prev" title="xlstm_jax.trainer.optimizer" href="../index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../../../_static/nxai_logo_light.svg" class="logo__image only-light" alt="xlstm-jax  documentation - Home"/>
    <img src="../../../../../_static/nxai_logo_dark.svg" class="logo__image only-dark pst-js-only" alt="xlstm-jax  documentation - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../dataset_preparation.html">Dataset Preparation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../example_training.html">Training large language models in xlstm-jax</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../configuration_with_hydra.html">Configuring Experiments with Hydra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../distributed_training.html">Distributed Training</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../../../../index.html">API Reference</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active has-children"><a class="reference internal" href="../../../index.html">xlstm_jax</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../../common_types/index.html">xlstm_jax.common_types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../configs/index.html">xlstm_jax.configs</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../dataset/index.html">xlstm_jax.dataset</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../dataset/batch/index.html">xlstm_jax.dataset.batch</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../dataset/configs/index.html">xlstm_jax.dataset.configs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../dataset/grain_batch_rampup/index.html">xlstm_jax.dataset.grain_batch_rampup</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../dataset/grain_data_processing/index.html">xlstm_jax.dataset.grain_data_processing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../dataset/grain_iterator/index.html">xlstm_jax.dataset.grain_iterator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../dataset/grain_transforms/index.html">xlstm_jax.dataset.grain_transforms</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../dataset/hf_tokenizer/index.html">xlstm_jax.dataset.hf_tokenizer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../dataset/input_pipeline_interface/index.html">xlstm_jax.dataset.input_pipeline_interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../dataset/lmeval_dataset/index.html">xlstm_jax.dataset.lmeval_dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../dataset/lmeval_pipeline/index.html">xlstm_jax.dataset.lmeval_pipeline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../dataset/multihost_dataloading/index.html">xlstm_jax.dataset.multihost_dataloading</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../dataset/synthetic_dataloading/index.html">xlstm_jax.dataset.synthetic_dataloading</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../../../define_hydra_schemas/index.html">xlstm_jax.define_hydra_schemas</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../distributed/index.html">xlstm_jax.distributed</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../distributed/array_utils/index.html">xlstm_jax.distributed.array_utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../distributed/data_parallel/index.html">xlstm_jax.distributed.data_parallel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../distributed/mesh_utils/index.html">xlstm_jax.distributed.mesh_utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../distributed/pipeline_parallel/index.html">xlstm_jax.distributed.pipeline_parallel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../distributed/single_gpu/index.html">xlstm_jax.distributed.single_gpu</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../distributed/tensor_parallel/index.html">xlstm_jax.distributed.tensor_parallel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../distributed/xla_utils/index.html">xlstm_jax.distributed.xla_utils</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../../../import_utils/index.html">xlstm_jax.import_utils</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../kernels/index.html">xlstm_jax.kernels</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../kernels/kernel_utils/index.html">xlstm_jax.kernels.kernel_utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../kernels/mlstm_chunkwise/index.html">xlstm_jax.kernels.mlstm_chunkwise</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../kernels/mlstm_recurrent/index.html">xlstm_jax.kernels.mlstm_recurrent</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../kernels/stride_utils/index.html">xlstm_jax.kernels.stride_utils</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../../../main_train/index.html">xlstm_jax.main_train</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../models/index.html">xlstm_jax.models</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../models/configs/index.html">xlstm_jax.models.configs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../models/llama/index.html">xlstm_jax.models.llama</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../models/shared/index.html">xlstm_jax.models.shared</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../models/xlstm_clean/index.html">xlstm_jax.models.xlstm_clean</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../models/xlstm_parallel/index.html">xlstm_jax.models.xlstm_parallel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../models/xlstm_pytorch/index.html">xlstm_jax.models.xlstm_pytorch</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../../../resume_training/index.html">xlstm_jax.resume_training</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../start_training/index.html">xlstm_jax.start_training</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../train_init_fns/index.html">xlstm_jax.train_init_fns</a></li>
<li class="toctree-l3 current active has-children"><a class="reference internal" href="../../index.html">xlstm_jax.trainer</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../../base/index.html">xlstm_jax.trainer.base</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../callbacks/index.html">xlstm_jax.trainer.callbacks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../data_module/index.html">xlstm_jax.trainer.data_module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../llm/index.html">xlstm_jax.trainer.llm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../logger/index.html">xlstm_jax.trainer.logger</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../metrics/index.html">xlstm_jax.trainer.metrics</a></li>
<li class="toctree-l4 current active"><a class="reference internal" href="../index.html">xlstm_jax.trainer.optimizer</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../utils/index.html">xlstm_jax.utils</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../utils/error_logging_utils/index.html">xlstm_jax.utils.error_logging_utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../utils/model_param_handling/index.html">xlstm_jax.utils.model_param_handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../utils/pytree_utils/index.html">xlstm_jax.utils.pytree_utils</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../lmeval_extended_evaluation/index.html">lmeval_extended_evaluation</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../../../_sources/autoapi/xlstm_jax/trainer/optimizer/ademamix/index.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>xlstm_jax.trainer.optimizer.ademamix</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#classes">Classes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#functions">Functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-contents">Module Contents</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#xlstm_jax.trainer.optimizer.ademamix.alpha_scheduler"><code class="docutils literal notranslate"><span class="pre">alpha_scheduler()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#xlstm_jax.trainer.optimizer.ademamix.beta3_scheduler"><code class="docutils literal notranslate"><span class="pre">beta3_scheduler()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#xlstm_jax.trainer.optimizer.ademamix.ScaleByAdemamixState"><code class="docutils literal notranslate"><span class="pre">ScaleByAdemamixState</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#xlstm_jax.trainer.optimizer.ademamix.ScaleByAdemamixState.count"><code class="docutils literal notranslate"><span class="pre">ScaleByAdemamixState.count</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#xlstm_jax.trainer.optimizer.ademamix.ScaleByAdemamixState.count_m2"><code class="docutils literal notranslate"><span class="pre">ScaleByAdemamixState.count_m2</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#xlstm_jax.trainer.optimizer.ademamix.ScaleByAdemamixState.m1"><code class="docutils literal notranslate"><span class="pre">ScaleByAdemamixState.m1</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#xlstm_jax.trainer.optimizer.ademamix.ScaleByAdemamixState.m2"><code class="docutils literal notranslate"><span class="pre">ScaleByAdemamixState.m2</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#xlstm_jax.trainer.optimizer.ademamix.ScaleByAdemamixState.nu"><code class="docutils literal notranslate"><span class="pre">ScaleByAdemamixState.nu</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#xlstm_jax.trainer.optimizer.ademamix.ademamix"><code class="docutils literal notranslate"><span class="pre">ademamix()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#xlstm_jax.trainer.optimizer.ademamix.scale_by_ademamix"><code class="docutils literal notranslate"><span class="pre">scale_by_ademamix()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#xlstm_jax.trainer.optimizer.ademamix.tree_cast"><code class="docutils literal notranslate"><span class="pre">tree_cast()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#xlstm_jax.trainer.optimizer.ademamix.tree_zeros_like"><code class="docutils literal notranslate"><span class="pre">tree_zeros_like()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#xlstm_jax.trainer.optimizer.ademamix.tree_update_moment"><code class="docutils literal notranslate"><span class="pre">tree_update_moment()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#xlstm_jax.trainer.optimizer.ademamix.tree_update_moment_per_elem_norm"><code class="docutils literal notranslate"><span class="pre">tree_update_moment_per_elem_norm()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#xlstm_jax.trainer.optimizer.ademamix.tree_bias_correction"><code class="docutils literal notranslate"><span class="pre">tree_bias_correction()</span></code></a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="module-xlstm_jax.trainer.optimizer.ademamix">
<span id="xlstm-jax-trainer-optimizer-ademamix"></span><h1>xlstm_jax.trainer.optimizer.ademamix<a class="headerlink" href="#module-xlstm_jax.trainer.optimizer.ademamix" title="Link to this heading">#</a></h1>
<p>Adapted from Apple’s official AdeMAMix implementation:
<a class="github reference external" href="https://github.com/apple/ml-ademamix/blob/main/optax/ademamix.py">apple/ml-ademamix</a></p>
<p>TODO: Check license and add it here.</p>
<section id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#xlstm_jax.trainer.optimizer.ademamix.ScaleByAdemamixState" title="xlstm_jax.trainer.optimizer.ademamix.ScaleByAdemamixState"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ScaleByAdemamixState</span></code></a></p></td>
<td><p>State for the AdEMAMix algorithm.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#xlstm_jax.trainer.optimizer.ademamix.alpha_scheduler" title="xlstm_jax.trainer.optimizer.ademamix.alpha_scheduler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">alpha_scheduler</span></code></a>(alpha[, alpha_start, warmup])</p></td>
<td><p>Linear scheduler for the mixing coefficient alpha in AdEMAMix.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#xlstm_jax.trainer.optimizer.ademamix.beta3_scheduler" title="xlstm_jax.trainer.optimizer.ademamix.beta3_scheduler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">beta3_scheduler</span></code></a>(beta_end[, beta_start, warmup])</p></td>
<td><p>Linear scheduler for the EMA parameter beta3 in AdEMAMix.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#xlstm_jax.trainer.optimizer.ademamix.ademamix" title="xlstm_jax.trainer.optimizer.ademamix.ademamix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ademamix</span></code></a>(lr[, b1, b2, b3, alpha, b3_scheduler, ...])</p></td>
<td><p>AdEMAMix.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#xlstm_jax.trainer.optimizer.ademamix.scale_by_ademamix" title="xlstm_jax.trainer.optimizer.ademamix.scale_by_ademamix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scale_by_ademamix</span></code></a>(b1, b2, b3, alpha, b3_scheduler, ...)</p></td>
<td><p>Scales updates by the AdEMAMix algorithm.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#xlstm_jax.trainer.optimizer.ademamix.tree_cast" title="xlstm_jax.trainer.optimizer.ademamix.tree_cast"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tree_cast</span></code></a>(tree, dtype)</p></td>
<td><p>Cast tree to given dtype, skip if None.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#xlstm_jax.trainer.optimizer.ademamix.tree_zeros_like" title="xlstm_jax.trainer.optimizer.ademamix.tree_zeros_like"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tree_zeros_like</span></code></a>(tree[, dtype])</p></td>
<td><p>Creates an all-zeros tree with the same structure.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#xlstm_jax.trainer.optimizer.ademamix.tree_update_moment" title="xlstm_jax.trainer.optimizer.ademamix.tree_update_moment"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tree_update_moment</span></code></a>(updates, moments, decay, order)</p></td>
<td><p>Compute the exponential moving average of the <cite>order</cite>-th moment.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#xlstm_jax.trainer.optimizer.ademamix.tree_update_moment_per_elem_norm" title="xlstm_jax.trainer.optimizer.ademamix.tree_update_moment_per_elem_norm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tree_update_moment_per_elem_norm</span></code></a>(updates, moments, ...)</p></td>
<td><p>Compute the EMA of the <cite>order</cite>-th moment of the element-wise norm.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#xlstm_jax.trainer.optimizer.ademamix.tree_bias_correction" title="xlstm_jax.trainer.optimizer.ademamix.tree_bias_correction"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tree_bias_correction</span></code></a>(moment, decay, count)</p></td>
<td><p>Performs bias correction. It becomes a no-op as count goes to infinity.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="xlstm_jax.trainer.optimizer.ademamix.alpha_scheduler">
<span class="sig-prename descclassname"><span class="pre">xlstm_jax.trainer.optimizer.ademamix.</span></span><span class="sig-name descname"><span class="pre">alpha_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warmup</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xlstm_jax.trainer.optimizer.ademamix.alpha_scheduler" title="Link to this definition">#</a></dt>
<dd><p>Linear scheduler for the mixing coefficient alpha in AdEMAMix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Final value of alpha.</p></li>
<li><p><strong>alpha_start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Initial value of alpha.</p></li>
<li><p><strong>warmup</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of steps for the warmup phase. Often set equal to the number of training steps.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A scheduler function that takes a step and returns the value of alpha.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>optax.Schedule</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xlstm_jax.trainer.optimizer.ademamix.beta3_scheduler">
<span class="sig-prename descclassname"><span class="pre">xlstm_jax.trainer.optimizer.ademamix.</span></span><span class="sig-name descname"><span class="pre">beta3_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">beta_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warmup</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xlstm_jax.trainer.optimizer.ademamix.beta3_scheduler" title="Link to this definition">#</a></dt>
<dd><p>Linear scheduler for the EMA parameter beta3 in AdEMAMix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>beta_end</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Final value of beta3.</p></li>
<li><p><strong>beta_start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Initial value of beta3. Often set equal to beta1.</p></li>
<li><p><strong>warmup</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of steps for the warmup phase. Often set equal to the number of training steps.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A scheduler function that takes a step and returns the value of beta3.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>optax.Schedule</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="xlstm_jax.trainer.optimizer.ademamix.ScaleByAdemamixState">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">xlstm_jax.trainer.optimizer.ademamix.</span></span><span class="sig-name descname"><span class="pre">ScaleByAdemamixState</span></span><a class="headerlink" href="#xlstm_jax.trainer.optimizer.ademamix.ScaleByAdemamixState" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-obj docutils literal notranslate"><span class="pre">NamedTuple</span></code></p>
<p>State for the AdEMAMix algorithm.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="xlstm_jax.trainer.optimizer.ademamix.ScaleByAdemamixState.count">
<span class="sig-name descname"><span class="pre">count</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">chex.Array</span></em><a class="headerlink" href="#xlstm_jax.trainer.optimizer.ademamix.ScaleByAdemamixState.count" title="Link to this definition">#</a></dt>
<dd><p>Step counter for the first momentum and adaptive learning rate.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xlstm_jax.trainer.optimizer.ademamix.ScaleByAdemamixState.count_m2">
<span class="sig-name descname"><span class="pre">count_m2</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">chex.Array</span></em><a class="headerlink" href="#xlstm_jax.trainer.optimizer.ademamix.ScaleByAdemamixState.count_m2" title="Link to this definition">#</a></dt>
<dd><p>Step counter for the slower momentum.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xlstm_jax.trainer.optimizer.ademamix.ScaleByAdemamixState.m1">
<span class="sig-name descname"><span class="pre">m1</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">optax._src.base.Updates</span></em><a class="headerlink" href="#xlstm_jax.trainer.optimizer.ademamix.ScaleByAdemamixState.m1" title="Link to this definition">#</a></dt>
<dd><p>Fast EMA.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xlstm_jax.trainer.optimizer.ademamix.ScaleByAdemamixState.m2">
<span class="sig-name descname"><span class="pre">m2</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">optax._src.base.Updates</span></em><a class="headerlink" href="#xlstm_jax.trainer.optimizer.ademamix.ScaleByAdemamixState.m2" title="Link to this definition">#</a></dt>
<dd><p>Slow EMA.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xlstm_jax.trainer.optimizer.ademamix.ScaleByAdemamixState.nu">
<span class="sig-name descname"><span class="pre">nu</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">optax._src.base.Updates</span></em><a class="headerlink" href="#xlstm_jax.trainer.optimizer.ademamix.ScaleByAdemamixState.nu" title="Link to this definition">#</a></dt>
<dd><p>Second moment estimate.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xlstm_jax.trainer.optimizer.ademamix.ademamix">
<span class="sig-prename descclassname"><span class="pre">xlstm_jax.trainer.optimizer.ademamix.</span></span><span class="sig-name descname"><span class="pre">ademamix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.999</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9999</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b3_scheduler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_scheduler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_root</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xlstm_jax.trainer.optimizer.ademamix.ademamix" title="Link to this definition">#</a></dt>
<dd><p>AdEMAMix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lr</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><em>optax.Schedule</em>) – A global scaling factor, either fixed or evolving along
iterations with a scheduler, see <a class="reference external" href="https://optax.readthedocs.io/en/latest/api/transformations.html#optax.scale_by_learning_rate" title="(in Optax)"><code class="xref py py-func docutils literal notranslate"><span class="pre">optax.scale_by_learning_rate()</span></code></a>.</p></li>
<li><p><strong>b1</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Exponential decay rate to track the fast EMA.</p></li>
<li><p><strong>b2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Exponential decay rate to track the second moment of past gradients.</p></li>
<li><p><strong>b3</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Exponential decay rate to track the slow EMA.</p></li>
<li><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Mixing coeficient use for the linear combination of the fast and slow EMAs.</p></li>
<li><p><strong>b3_scheduler</strong> (<em>optax.Schedule</em><em> | </em><em>None</em>) – an optional scheduler function, given a timestep, returns the
value of b3. Use <cite>beta3_scheduler(b3,b1,T_b3)</cite> to follow the AdEMAMix paper.</p></li>
<li><p><strong>alpha_scheduler</strong> (<em>optax.Schedule</em><em> | </em><em>None</em>) – an optional scheduler function, given a timestep, returns the
value of alpha. Use <cite>alpha_scheduler(alpha,0,T_alpha)</cite> to follow the
AdEMAMix paper.</p></li>
<li><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – A small constant applied to denominator outside the square root
(as in the Adam paper) to avoid dividing by zero when rescaling.</p></li>
<li><p><strong>eps_root</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – A small constant applied to denominator inside the square root (as
in RMSProp), to avoid dividing by zero when rescaling. This is needed for
instance when computing (meta-)gradients through Adam.</p></li>
<li><p><strong>mu_dtype</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.dtype.html#jax.numpy.dtype" title="(in JAX)"><em>jax.numpy.dtype</em></a><em> | </em><em>None</em>) – Optional <cite>dtype</cite> to be used for the first order accumulator; if
<cite>None</cite> then the <cite>dtype</cite> is inferred from <cite>params</cite> and <cite>updates</cite>.</p></li>
<li><p><strong>weight_decay</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Strength of the weight decay regularization. Note that this
weight decay is multiplied with the learning rate. This is consistent
with other frameworks such as PyTorch, but different from
(Loshchilov et al., 2019) where the weight decay is only multiplied with
the “schedule multiplier”, but not the base learning rate.</p></li>
<li><p><strong>mask</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.13)"><em>collections.abc.Callable</em></a><em>[</em><em>[</em><em>xlstm_jax.common_types.PyTree</em><em>]</em><em>, </em><em>xlstm_jax.common_types.PyTree</em><em>] </em><em>| </em><em>None</em>) – A tree with same structure as (or a prefix of) the params PyTree,
or a Callable that returns such a pytree given the params/updates.
The leaves should be booleans, <cite>True</cite> for leaves/subtrees you want to
apply the weight decay to, and <cite>False</cite> for those you want to skip. Note
that the Adam gradient transformations are applied to all parameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The corresponding <cite>GradientTransformation</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://optax.readthedocs.io/en/latest/api/transformations.html#optax.GradientTransformation" title="(in Optax)">optax.GradientTransformation</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xlstm_jax.trainer.optimizer.ademamix.scale_by_ademamix">
<span class="sig-prename descclassname"><span class="pre">xlstm_jax.trainer.optimizer.ademamix.</span></span><span class="sig-name descname"><span class="pre">scale_by_ademamix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b3_scheduler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_scheduler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps_root</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xlstm_jax.trainer.optimizer.ademamix.scale_by_ademamix" title="Link to this definition">#</a></dt>
<dd><p>Scales updates by the AdEMAMix algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>b1</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Exponential decay rate to track the fast EMA.</p></li>
<li><p><strong>b2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Exponential decay rate to track the second moment of past gradients.</p></li>
<li><p><strong>b3</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Exponential decay rate to track the slow EMA.</p></li>
<li><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Mixing coeficient use for the linear combination of the fast and slow EMAs.</p></li>
<li><p><strong>b3_scheduler</strong> (<em>optax.Schedule</em><em> | </em><em>None</em>) – an optional scheduler function, given a timestep, returns the
value of b3. Use <cite>beta3_scheduler(b3,b1,T_b3)</cite> to follow the AdEMAMix paper.</p></li>
<li><p><strong>alpha_scheduler</strong> (<em>optax.Schedule</em><em> | </em><em>None</em>) – an optional scheduler function, given a timestep, returns the
value of alpha. Use <cite>alpha_scheduler(alpha,0,T_alpha)</cite> to follow the
AdEMAMix paper.</p></li>
<li><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – A small constant applied to denominator outside the square root
(as in the Adam paper) to avoid dividing by zero when rescaling.</p></li>
<li><p><strong>eps_root</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – A small constant applied to denominator inside the square root (as
in RMSProp), to avoid dividing by zero when rescaling. This is needed for
instance when computing (meta-)gradients through Adam.</p></li>
<li><p><strong>mu_dtype</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.dtype.html#jax.numpy.dtype" title="(in JAX)"><em>jax.numpy.dtype</em></a><em> | </em><em>None</em>) – Optional <cite>dtype</cite> to be used for the first order accumulator; if
<cite>None</cite> then the <cite>dtype</cite> is inferred from <cite>params</cite> and <cite>updates</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The corresponding <cite>GradientTransformation</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://optax.readthedocs.io/en/latest/api/transformations.html#optax.GradientTransformation" title="(in Optax)">optax.GradientTransformation</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xlstm_jax.trainer.optimizer.ademamix.tree_cast">
<span class="sig-prename descclassname"><span class="pre">xlstm_jax.trainer.optimizer.ademamix.</span></span><span class="sig-name descname"><span class="pre">tree_cast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xlstm_jax.trainer.optimizer.ademamix.tree_cast" title="Link to this definition">#</a></dt>
<dd><p>Cast tree to given dtype, skip if None.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tree</strong> (<em>xlstm_jax.common_types.PyTree</em>)</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.dtype.html#jax.numpy.dtype" title="(in JAX)"><em>jax.numpy.dtype</em></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>xlstm_jax.common_types.PyTree</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xlstm_jax.trainer.optimizer.ademamix.tree_zeros_like">
<span class="sig-prename descclassname"><span class="pre">xlstm_jax.trainer.optimizer.ademamix.</span></span><span class="sig-name descname"><span class="pre">tree_zeros_like</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tree</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xlstm_jax.trainer.optimizer.ademamix.tree_zeros_like" title="Link to this definition">#</a></dt>
<dd><p>Creates an all-zeros tree with the same structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tree</strong> (<em>xlstm_jax.common_types.PyTree</em>) – pytree.</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.numpy.dtype.html#jax.numpy.dtype" title="(in JAX)"><em>jax.numpy.dtype</em></a><em> | </em><em>None</em>) – optional dtype to use for the tree of zeros.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an all-zeros tree with the same structure as <code class="docutils literal notranslate"><span class="pre">tree</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xlstm_jax.trainer.optimizer.ademamix.tree_update_moment">
<span class="sig-prename descclassname"><span class="pre">xlstm_jax.trainer.optimizer.ademamix.</span></span><span class="sig-name descname"><span class="pre">tree_update_moment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">updates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moments</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decay</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xlstm_jax.trainer.optimizer.ademamix.tree_update_moment" title="Link to this definition">#</a></dt>
<dd><p>Compute the exponential moving average of the <cite>order</cite>-th moment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>updates</strong> (<em>xlstm_jax.common_types.PyTree</em>) – Gradients.</p></li>
<li><p><strong>moments</strong> (<em>xlstm_jax.common_types.PyTree</em>) – Moments.</p></li>
<li><p><strong>decay</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>jax.Array</em></a>) – Decay rate.</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>jax.Array</em></a>) – Order of the moment.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated moments.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xlstm_jax.common_types.PyTree</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xlstm_jax.trainer.optimizer.ademamix.tree_update_moment_per_elem_norm">
<span class="sig-prename descclassname"><span class="pre">xlstm_jax.trainer.optimizer.ademamix.</span></span><span class="sig-name descname"><span class="pre">tree_update_moment_per_elem_norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">updates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">moments</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decay</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xlstm_jax.trainer.optimizer.ademamix.tree_update_moment_per_elem_norm" title="Link to this definition">#</a></dt>
<dd><p>Compute the EMA of the <cite>order</cite>-th moment of the element-wise norm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>updates</strong> (<em>xlstm_jax.common_types.PyTree</em>) – Gradients.</p></li>
<li><p><strong>moments</strong> (<em>xlstm_jax.common_types.PyTree</em>) – Moments.</p></li>
<li><p><strong>decay</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>jax.Array</em></a>) – Decay rate.</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>jax.Array</em></a>) – Order of the moment.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated moments.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xlstm_jax.common_types.PyTree</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xlstm_jax.trainer.optimizer.ademamix.tree_bias_correction">
<span class="sig-prename descclassname"><span class="pre">xlstm_jax.trainer.optimizer.ademamix.</span></span><span class="sig-name descname"><span class="pre">tree_bias_correction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">moment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decay</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">count</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xlstm_jax.trainer.optimizer.ademamix.tree_bias_correction" title="Link to this definition">#</a></dt>
<dd><p>Performs bias correction. It becomes a no-op as count goes to infinity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>moment</strong> (<em>xlstm_jax.common_types.PyTree</em>) – Moments.</p></li>
<li><p><strong>decay</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>jax.Array</em></a>) – Decay rate.</p></li>
<li><p><strong>count</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>jax.Array</em></a>) – Step count.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The bias-corrected moments.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xlstm_jax.common_types.PyTree</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">xlstm_jax.trainer.optimizer</p>
      </div>
    </a>
    <a class="right-next"
       href="../optimizer/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">xlstm_jax.trainer.optimizer.optimizer</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#classes">Classes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#functions">Functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-contents">Module Contents</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#xlstm_jax.trainer.optimizer.ademamix.alpha_scheduler"><code class="docutils literal notranslate"><span class="pre">alpha_scheduler()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#xlstm_jax.trainer.optimizer.ademamix.beta3_scheduler"><code class="docutils literal notranslate"><span class="pre">beta3_scheduler()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#xlstm_jax.trainer.optimizer.ademamix.ScaleByAdemamixState"><code class="docutils literal notranslate"><span class="pre">ScaleByAdemamixState</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#xlstm_jax.trainer.optimizer.ademamix.ScaleByAdemamixState.count"><code class="docutils literal notranslate"><span class="pre">ScaleByAdemamixState.count</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#xlstm_jax.trainer.optimizer.ademamix.ScaleByAdemamixState.count_m2"><code class="docutils literal notranslate"><span class="pre">ScaleByAdemamixState.count_m2</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#xlstm_jax.trainer.optimizer.ademamix.ScaleByAdemamixState.m1"><code class="docutils literal notranslate"><span class="pre">ScaleByAdemamixState.m1</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#xlstm_jax.trainer.optimizer.ademamix.ScaleByAdemamixState.m2"><code class="docutils literal notranslate"><span class="pre">ScaleByAdemamixState.m2</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#xlstm_jax.trainer.optimizer.ademamix.ScaleByAdemamixState.nu"><code class="docutils literal notranslate"><span class="pre">ScaleByAdemamixState.nu</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#xlstm_jax.trainer.optimizer.ademamix.ademamix"><code class="docutils literal notranslate"><span class="pre">ademamix()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#xlstm_jax.trainer.optimizer.ademamix.scale_by_ademamix"><code class="docutils literal notranslate"><span class="pre">scale_by_ademamix()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#xlstm_jax.trainer.optimizer.ademamix.tree_cast"><code class="docutils literal notranslate"><span class="pre">tree_cast()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#xlstm_jax.trainer.optimizer.ademamix.tree_zeros_like"><code class="docutils literal notranslate"><span class="pre">tree_zeros_like()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#xlstm_jax.trainer.optimizer.ademamix.tree_update_moment"><code class="docutils literal notranslate"><span class="pre">tree_update_moment()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#xlstm_jax.trainer.optimizer.ademamix.tree_update_moment_per_elem_norm"><code class="docutils literal notranslate"><span class="pre">tree_update_moment_per_elem_norm()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#xlstm_jax.trainer.optimizer.ademamix.tree_bias_correction"><code class="docutils literal notranslate"><span class="pre">tree_bias_correction()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By NXAI GmbH
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024, NXAI GmbH.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../../../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../../../../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>