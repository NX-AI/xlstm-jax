

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../../../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw &mdash; xlstm-jax  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../../../../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../../../../../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../../../../../../_static/graphviz.css?v=4ae1632d" />

  
      <script src="../../../../../../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../../../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../../../../../../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../../../../../../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../../../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../../../../search.html" />
    <link rel="next" title="xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.layer_factory" href="../layer_factory/index.html" />
    <link rel="prev" title="xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.config_utils" href="../config_utils/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../../../../../index.html" class="icon icon-home">
            xlstm-jax
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../../../../../configuration_with_hydra.html">Configuring Experiments with Hydra</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../../../../../index.html">API Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../../../../../index.html">xlstm_jax</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../../../../../../index.html#submodules">Submodules</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../../../../../../common_types/index.html">xlstm_jax.common_types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../../configs/index.html">xlstm_jax.configs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../../dataset/index.html">xlstm_jax.dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../../define_hydra_schemas/index.html">xlstm_jax.define_hydra_schemas</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../../distributed/index.html">xlstm_jax.distributed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../../import_utils/index.html">xlstm_jax.import_utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../../kernels/index.html">xlstm_jax.kernels</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../../main_train/index.html">xlstm_jax.main_train</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="../../../../../index.html">xlstm_jax.models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../../resume_training/index.html">xlstm_jax.resume_training</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../../start_training/index.html">xlstm_jax.start_training</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../../train_init_fns/index.html">xlstm_jax.train_init_fns</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../../trainer/index.html">xlstm_jax.trainer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../../../../utils/index.html">xlstm_jax.utils</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../../lmeval_extended_evaluation/index.html">lmeval_extended_evaluation</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../../../../index.html">xlstm-jax</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../../../../../index.html">API Reference</a></li>
          <li class="breadcrumb-item"><a href="../../../../../../index.html">xlstm_jax</a></li>
          <li class="breadcrumb-item"><a href="../../../../../index.html">xlstm_jax.models</a></li>
          <li class="breadcrumb-item"><a href="../../../../index.html">xlstm_jax.models.xlstm_parallel</a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">xlstm_jax.models.xlstm_parallel.blocks</a></li>
          <li class="breadcrumb-item"><a href="../../index.html">xlstm_jax.models.xlstm_parallel.blocks.mlstm</a></li>
          <li class="breadcrumb-item"><a href="../index.html">xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend</a></li>
      <li class="breadcrumb-item active">xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../../../../../_sources/autoapi/xlstm_jax/models/xlstm_parallel/blocks/mlstm/backend/fwbw/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw">
<span id="xlstm-jax-models-xlstm-parallel-blocks-mlstm-backend-fwbw"></span><h1>xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw<a class="headerlink" href="#module-xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw" title="Link to this heading"></a></h1>
<section id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Link to this heading"></a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.mLSTMBackendFwbwConfig" title="xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.mLSTMBackendFwbwConfig"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mLSTMBackendFwbwConfig</span></code></a></p></td>
<td><p>Configuration object for the mLSTM fwbw backend.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.mLSTMBackendFwbw" title="xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.mLSTMBackendFwbw"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mLSTMBackendFwbw</span></code></a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</section>
<section id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Link to this heading"></a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.rev_cumsum_off" title="xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.rev_cumsum_off"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rev_cumsum_off</span></code></a>(x)</p></td>
<td><p>Compute the reverse cumulative sum of a tensor with an offset.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.rev_cumsum" title="xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.rev_cumsum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rev_cumsum</span></code></a>(x)</p></td>
<td><p>Compute the reverse cumulative sum of a tensor.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.causal_forget_matrix" title="xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.causal_forget_matrix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">causal_forget_matrix</span></code></a>(forget_gates)</p></td>
<td><p>Compute the causal forget matrix from the forget gates.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.fwbw_forward" title="xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.fwbw_forward"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fwbw_forward</span></code></a>(q, k, v, i, f, config[, initial_C, ...])</p></td>
<td><p>Forward pass of the mLSTM fwbw backend.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.fwbw_backward" title="xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.fwbw_backward"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fwbw_backward</span></code></a>(ctx, dh, config[, dc_last, dn_last, dm_last])</p></td>
<td><p>Backward pass of the mLSTM fwbw backend.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.mlstm_fwbw_custom_grad" title="xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.mlstm_fwbw_custom_grad"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mlstm_fwbw_custom_grad</span></code></a>(config)</p></td>
<td><p>Returns an autograd function that computes the gradient itself.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.mLSTMBackendFwbwConfig">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.</span></span><span class="sig-name descname"><span class="pre">mLSTMBackendFwbwConfig</span></span><a class="headerlink" href="#xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.mLSTMBackendFwbwConfig" title="Link to this definition"></a></dt>
<dd><p>Configuration object for the mLSTM fwbw backend.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.mLSTMBackendFwbwConfig.chunk_size">
<span class="sig-name descname"><span class="pre">chunk_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">512</span></em><a class="headerlink" href="#xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.mLSTMBackendFwbwConfig.chunk_size" title="Link to this definition"></a></dt>
<dd><p>Chunk size for the kernel computation.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.mLSTMBackendFwbwConfig.return_state">
<span class="sig-name descname"><span class="pre">return_state</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.mLSTMBackendFwbwConfig.return_state" title="Link to this definition"></a></dt>
<dd><p>Whether to return the last state. USeful for inference.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.mLSTMBackendFwbwConfig.use_initial_state">
<span class="sig-name descname"><span class="pre">use_initial_state</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.mLSTMBackendFwbwConfig.use_initial_state" title="Link to this definition"></a></dt>
<dd><p>Whether to start from an initial state or zeros.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.mLSTMBackendFwbwConfig.keep_G">
<span class="sig-name descname"><span class="pre">keep_G</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.mLSTMBackendFwbwConfig.keep_G" title="Link to this definition"></a></dt>
<dd><p>Whether to save the G matrix for the backward pass.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.mLSTMBackendFwbwConfig.keep_gates">
<span class="sig-name descname"><span class="pre">keep_gates</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.mLSTMBackendFwbwConfig.keep_gates" title="Link to this definition"></a></dt>
<dd><p>Whether to save the gates for the backward pass.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.mLSTMBackendFwbwConfig.keep_M">
<span class="sig-name descname"><span class="pre">keep_M</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.mLSTMBackendFwbwConfig.keep_M" title="Link to this definition"></a></dt>
<dd><p>Whether to save the M matrix for the backward pass.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.mLSTMBackendFwbwConfig.keep_c">
<span class="sig-name descname"><span class="pre">keep_c</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.mLSTMBackendFwbwConfig.keep_c" title="Link to this definition"></a></dt>
<dd><p>Whether to save the c matrix for the backward pass.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.mLSTMBackendFwbwConfig.stabilize_correctly">
<span class="sig-name descname"><span class="pre">stabilize_correctly</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.mLSTMBackendFwbwConfig.stabilize_correctly" title="Link to this definition"></a></dt>
<dd><p>Whether to stabilize the output correctly. This is only needed if no GroupNorm is applied after the mLSTM.
If GroupNorm is applied, this can be set to False, as results after GroupNorm will be the same.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.mLSTMBackendFwbwConfig.assign_model_config_params">
<span class="sig-name descname"><span class="pre">assign_model_config_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.mLSTMBackendFwbwConfig.assign_model_config_params" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.rev_cumsum_off">
<span class="sig-prename descclassname"><span class="pre">xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.</span></span><span class="sig-name descname"><span class="pre">rev_cumsum_off</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.rev_cumsum_off" title="Link to this definition"></a></dt>
<dd><p>Compute the reverse cumulative sum of a tensor with an offset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>jax.Array</em></a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.rev_cumsum">
<span class="sig-prename descclassname"><span class="pre">xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.</span></span><span class="sig-name descname"><span class="pre">rev_cumsum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.rev_cumsum" title="Link to this definition"></a></dt>
<dd><p>Compute the reverse cumulative sum of a tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>jax.Array</em></a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.causal_forget_matrix">
<span class="sig-prename descclassname"><span class="pre">xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.</span></span><span class="sig-name descname"><span class="pre">causal_forget_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forget_gates</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.causal_forget_matrix" title="Link to this definition"></a></dt>
<dd><p>Compute the causal forget matrix from the forget gates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>forget_gates</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>jax.Array</em></a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.fwbw_forward">
<span class="sig-prename descclassname"><span class="pre">xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.</span></span><span class="sig-name descname"><span class="pre">fwbw_forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_C</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.fwbw_forward" title="Link to this definition"></a></dt>
<dd><p>Forward pass of the mLSTM fwbw backend.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>jax.Array</em></a>) – query tensor</p></li>
<li><p><strong>k</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>jax.Array</em></a>) – key tensor</p></li>
<li><p><strong>v</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>jax.Array</em></a>) – value tensor</p></li>
<li><p><strong>i</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>jax.Array</em></a>) – input gate tensor</p></li>
<li><p><strong>f</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>jax.Array</em></a>) – forget gate tensor</p></li>
<li><p><strong>config</strong> (<a class="reference internal" href="#xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.mLSTMBackendFwbwConfig" title="xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.mLSTMBackendFwbwConfig"><em>mLSTMBackendFwbwConfig</em></a>) – configuration object</p></li>
<li><p><strong>initial_C</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>jax.Array</em></a><em> | </em><em>None</em>) – initial chunk tensor. Defaults to None.</p></li>
<li><p><strong>initial_n</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>jax.Array</em></a><em> | </em><em>None</em>) – initial n tensor. Defaults to None.</p></li>
<li><p><strong>initial_m</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>jax.Array</em></a><em> | </em><em>None</em>) – initial m tensor. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output tensor and context for backward.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a>[<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)">jax.Array</a>, <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.13)">collections.abc.Sequence</a>[<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)">jax.Array</a>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.fwbw_backward">
<span class="sig-prename descclassname"><span class="pre">xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.</span></span><span class="sig-name descname"><span class="pre">fwbw_backward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ctx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dc_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dn_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dm_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.fwbw_backward" title="Link to this definition"></a></dt>
<dd><p>Backward pass of the mLSTM fwbw backend.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ctx</strong> (<em>Sequence</em><em>[</em><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>jax.Array</em></a><em>]</em>) – context from forward pass.</p></li>
<li><p><strong>dh</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>jax.Array</em></a>) – gradient tensor.</p></li>
<li><p><strong>config</strong> (<a class="reference internal" href="../../../../../xlstm_pytorch/blocks/mlstm/backend/fwbw/index.html#xlstm_jax.models.xlstm_pytorch.blocks.mlstm.backend.fwbw.mLSTMfwbwConfig" title="xlstm_jax.models.xlstm_pytorch.blocks.mlstm.backend.fwbw.mLSTMfwbwConfig"><em>mLSTMfwbwConfig</em></a>) – configuration object.</p></li>
<li><p><strong>dc_last</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>jax.Array</em></a><em>, </em><em>optional</em>) – last chunk tensor. Defaults to None.</p></li>
<li><p><strong>dn_last</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>jax.Array</em></a><em>, </em><em>optional</em>) – last n tensor. Defaults to None.</p></li>
<li><p><strong>dm_last</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>jax.Array</em></a><em>, </em><em>optional</em>) – last m tensor. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>tuple[jax.Array, jax.Array, jax.Array, jax.Array, jax.Array,</dt><dd><p>jax.Array | None, jax.Array | None, jax.Array | None]: gradients.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a>[<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)">jax.Array</a>, <a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)">jax.Array</a>, <a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)">jax.Array</a>, <a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)">jax.Array</a>, <a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)">jax.Array</a>, <a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)">jax.Array</a> | None, <a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)">jax.Array</a> | None, <a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)">jax.Array</a> | None]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.mlstm_fwbw_custom_grad">
<span class="sig-prename descclassname"><span class="pre">xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.</span></span><span class="sig-name descname"><span class="pre">mlstm_fwbw_custom_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.mlstm_fwbw_custom_grad" title="Link to this definition"></a></dt>
<dd><p>Returns an autograd function that computes the gradient itself.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<a class="reference internal" href="../../../../../xlstm_pytorch/blocks/mlstm/backend/fwbw/index.html#xlstm_jax.models.xlstm_pytorch.blocks.mlstm.backend.fwbw.mLSTMfwbwConfig" title="xlstm_jax.models.xlstm_pytorch.blocks.mlstm.backend.fwbw.mLSTMfwbwConfig"><em>mLSTMfwbwConfig</em></a>) – configuration object.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>autograd function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>function</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.mLSTMBackendFwbw">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.</span></span><span class="sig-name descname"><span class="pre">mLSTMBackendFwbw</span></span><a class="headerlink" href="#xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.mLSTMBackendFwbw" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="../config/index.html#xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.config.mLSTMBackend" title="xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.config.mLSTMBackend"><code class="xref py py-obj docutils literal notranslate"><span class="pre">xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.config.mLSTMBackend</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.mLSTMBackendFwbw.config_class">
<span class="sig-name descname"><span class="pre">config_class</span></span><a class="headerlink" href="#xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.mLSTMBackendFwbw.config_class" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.mLSTMBackendFwbw.can_vmap_over_heads">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">can_vmap_over_heads</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></em><a class="headerlink" href="#xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.fwbw.mLSTMBackendFwbw.can_vmap_over_heads" title="Link to this definition"></a></dt>
<dd><p>Whether the backend can be vmaped over the heads dimension.</p>
<p>The backend is written independent of the heads dimension, and thus can be vmapped.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../config_utils/index.html" class="btn btn-neutral float-left" title="xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.config_utils" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../layer_factory/index.html" class="btn btn-neutral float-right" title="xlstm_jax.models.xlstm_parallel.blocks.mlstm.backend.layer_factory" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, NXAI.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>