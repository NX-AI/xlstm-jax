
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Configuring Experiments with Hydra &#8212; xlstm-jax  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=9df3ab08" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'configuration_with_hydra';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Distributed Training" href="distributed_training.html" />
    <link rel="prev" title="Training large language models in xlstm-jax" href="example_training.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/nxai_logo_light.svg" class="logo__image only-light" alt="xlstm-jax  documentation - Home"/>
    <img src="_static/nxai_logo_dark.svg" class="logo__image only-dark pst-js-only" alt="xlstm-jax  documentation - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataset_preparation.html">Dataset Preparation</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_training.html">Training large language models in xlstm-jax</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Configuring Experiments with Hydra</a></li>
<li class="toctree-l1"><a class="reference internal" href="distributed_training.html">Distributed Training</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="autoapi/index.html">API Reference</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="autoapi/xlstm_jax/index.html">xlstm_jax</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="autoapi/xlstm_jax/common_types/index.html">xlstm_jax.common_types</a></li>
<li class="toctree-l3"><a class="reference internal" href="autoapi/xlstm_jax/configs/index.html">xlstm_jax.configs</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="autoapi/xlstm_jax/dataset/index.html">xlstm_jax.dataset</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="autoapi/xlstm_jax/dataset/batch/index.html">xlstm_jax.dataset.batch</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/xlstm_jax/dataset/configs/index.html">xlstm_jax.dataset.configs</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/xlstm_jax/dataset/grain_batch_rampup/index.html">xlstm_jax.dataset.grain_batch_rampup</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/xlstm_jax/dataset/grain_data_processing/index.html">xlstm_jax.dataset.grain_data_processing</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/xlstm_jax/dataset/grain_iterator/index.html">xlstm_jax.dataset.grain_iterator</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/xlstm_jax/dataset/grain_transforms/index.html">xlstm_jax.dataset.grain_transforms</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/xlstm_jax/dataset/hf_tokenizer/index.html">xlstm_jax.dataset.hf_tokenizer</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/xlstm_jax/dataset/input_pipeline_interface/index.html">xlstm_jax.dataset.input_pipeline_interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/xlstm_jax/dataset/lmeval_dataset/index.html">xlstm_jax.dataset.lmeval_dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/xlstm_jax/dataset/lmeval_pipeline/index.html">xlstm_jax.dataset.lmeval_pipeline</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/xlstm_jax/dataset/multihost_dataloading/index.html">xlstm_jax.dataset.multihost_dataloading</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/xlstm_jax/dataset/synthetic_dataloading/index.html">xlstm_jax.dataset.synthetic_dataloading</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="autoapi/xlstm_jax/define_hydra_schemas/index.html">xlstm_jax.define_hydra_schemas</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="autoapi/xlstm_jax/distributed/index.html">xlstm_jax.distributed</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="autoapi/xlstm_jax/distributed/array_utils/index.html">xlstm_jax.distributed.array_utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/xlstm_jax/distributed/data_parallel/index.html">xlstm_jax.distributed.data_parallel</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/xlstm_jax/distributed/mesh_utils/index.html">xlstm_jax.distributed.mesh_utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/xlstm_jax/distributed/pipeline_parallel/index.html">xlstm_jax.distributed.pipeline_parallel</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/xlstm_jax/distributed/single_gpu/index.html">xlstm_jax.distributed.single_gpu</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/xlstm_jax/distributed/tensor_parallel/index.html">xlstm_jax.distributed.tensor_parallel</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/xlstm_jax/distributed/xla_utils/index.html">xlstm_jax.distributed.xla_utils</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="autoapi/xlstm_jax/import_utils/index.html">xlstm_jax.import_utils</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="autoapi/xlstm_jax/kernels/index.html">xlstm_jax.kernels</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="autoapi/xlstm_jax/kernels/kernel_utils/index.html">xlstm_jax.kernels.kernel_utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/xlstm_jax/kernels/mlstm_chunkwise/index.html">xlstm_jax.kernels.mlstm_chunkwise</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/xlstm_jax/kernels/mlstm_recurrent/index.html">xlstm_jax.kernels.mlstm_recurrent</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/xlstm_jax/kernels/stride_utils/index.html">xlstm_jax.kernels.stride_utils</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="autoapi/xlstm_jax/main_train/index.html">xlstm_jax.main_train</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="autoapi/xlstm_jax/models/index.html">xlstm_jax.models</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="autoapi/xlstm_jax/models/configs/index.html">xlstm_jax.models.configs</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/xlstm_jax/models/llama/index.html">xlstm_jax.models.llama</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/xlstm_jax/models/shared/index.html">xlstm_jax.models.shared</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/xlstm_jax/models/xlstm_clean/index.html">xlstm_jax.models.xlstm_clean</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/xlstm_jax/models/xlstm_parallel/index.html">xlstm_jax.models.xlstm_parallel</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/xlstm_jax/models/xlstm_pytorch/index.html">xlstm_jax.models.xlstm_pytorch</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="autoapi/xlstm_jax/resume_training/index.html">xlstm_jax.resume_training</a></li>
<li class="toctree-l3"><a class="reference internal" href="autoapi/xlstm_jax/start_training/index.html">xlstm_jax.start_training</a></li>
<li class="toctree-l3"><a class="reference internal" href="autoapi/xlstm_jax/train_init_fns/index.html">xlstm_jax.train_init_fns</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="autoapi/xlstm_jax/trainer/index.html">xlstm_jax.trainer</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="autoapi/xlstm_jax/trainer/base/index.html">xlstm_jax.trainer.base</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/xlstm_jax/trainer/callbacks/index.html">xlstm_jax.trainer.callbacks</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/xlstm_jax/trainer/data_module/index.html">xlstm_jax.trainer.data_module</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/xlstm_jax/trainer/llm/index.html">xlstm_jax.trainer.llm</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/xlstm_jax/trainer/logger/index.html">xlstm_jax.trainer.logger</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/xlstm_jax/trainer/metrics/index.html">xlstm_jax.trainer.metrics</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/xlstm_jax/trainer/optimizer/index.html">xlstm_jax.trainer.optimizer</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="autoapi/xlstm_jax/utils/index.html">xlstm_jax.utils</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="autoapi/xlstm_jax/utils/error_logging_utils/index.html">xlstm_jax.utils.error_logging_utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/xlstm_jax/utils/model_param_handling/index.html">xlstm_jax.utils.model_param_handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/xlstm_jax/utils/pytree_utils/index.html">xlstm_jax.utils.pytree_utils</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="autoapi/lmeval_extended_evaluation/index.html">lmeval_extended_evaluation</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/configuration_with_hydra.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Configuring Experiments with Hydra</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#configuration-structure">Configuration Structure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-run-experiments">How to Run Experiments</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#remarks">Remarks</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-experiment-files">Using Experiment Files</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#type-checking-of-the-configurations">Type Checking of the Configurations</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-run-experiments-on-a-slurm-cluster">How to run experiments on a SLURM cluster</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-resume-an-experiment">How to Resume an Experiment?</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="configuring-experiments-with-hydra">
<h1>Configuring Experiments with Hydra<a class="headerlink" href="#configuring-experiments-with-hydra" title="Link to this heading">#</a></h1>
<p>This project uses Hydra for managing configurations. Hydra is a framework that simplifies the process of configuring complex applications by allowing you to compose configurations dynamically.</p>
<section id="configuration-structure">
<h2>Configuration Structure<a class="headerlink" href="#configuration-structure" title="Link to this heading">#</a></h2>
<p>The configuration files are organized in the <code class="docutils literal notranslate"><span class="pre">configs</span></code> directory. For now, the structure is as follows</p>
<ul>
<li><p>[<code class="docutils literal notranslate"><span class="pre">configs/</span></code>]: Contains all configuration files.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">config.yaml</span></code>: The main configuration file. In there, the default sub-configurations are specified by way of the
<code class="docutils literal notranslate"><span class="pre">defaults</span></code> list. Additionaly, global variables are defined.
The submodules are in subfolders:</p></li>
</ul>
<p>TODO: fill up once ready</p>
</li>
</ul>
</section>
<section id="how-to-run-experiments">
<h2>How to Run Experiments<a class="headerlink" href="#how-to-run-experiments" title="Link to this heading">#</a></h2>
<p>The principal entry point for hydra is the script <code class="docutils literal notranslate"><span class="pre">scripts/training/train_with_hydra.py</span></code>. On the command line, you can start a run locally by executing</p>
<p><code class="docutils literal notranslate"><span class="pre">PYTHONPATH=.</span> <span class="pre">python</span> <span class="pre">scripts/training/train_with_hydra.py</span></code>.</p>
<p>Note that currently, in order for the Triton kernels to work, the xlstm root folder must be added to
your <code class="docutils literal notranslate"><span class="pre">PYTHONPATH</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">main_train()</span></code> function in that file is decorated with:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@hydra</span><span class="o">.</span><span class="n">main</span><span class="p">(</span><span class="n">config_path</span><span class="o">=</span><span class="s2">&quot;../configs&quot;</span><span class="p">,</span> <span class="n">config_name</span><span class="o">=</span><span class="s2">&quot;config&quot;</span><span class="p">,</span> <span class="n">version_base</span><span class="o">=</span><span class="s2">&quot;1.3&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">main_train</span><span class="p">(</span><span class="n">cfg</span><span class="p">:</span> <span class="n">DictConfig</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>The decorator invokes Hydra and the following happens: Hydra looks in the folder <code class="docutils literal notranslate"><span class="pre">../configs</span></code> for a file named <code class="docutils literal notranslate"><span class="pre">config.yaml</span></code>. If it finds the file,
Hydra starts to compile the configuration from the defaults supplied in <code class="docutils literal notranslate"><span class="pre">configs/config.yaml</span></code>.
For example, if that file looks like this:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">defaults</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">config_schema</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">parallel</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">synthetic</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">synthetic</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">model</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mLSTM120M</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">_self_</span>


<span class="c1"># General hyperparameters. Will be put in their respective config modules once they are created.</span>

<span class="c1"># device. cpu or gpu</span>
<span class="nt">device</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cpu</span>
</pre></div>
</div>
<p>the following will happen:</p>
<ol class="arabic simple">
<li><p>The first line reads <code class="docutils literal notranslate"><span class="pre">-</span> <span class="pre">config_schema</span></code>. This is related to the use of
structured configs, which will be detailed elsewhere (TODO). As with all entries
in the defaults list, Hydra will look for parameters in the file and append it
to the compiled configuration.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-</span> <span class="pre">parallel:</span> <span class="pre">synthetic</span></code> means that Hydra will now look in the <code class="docutils literal notranslate"><span class="pre">parallel</span></code> subfolder for the <code class="docutils literal notranslate"><span class="pre">synthetic.yaml</span></code>
file and append all parameters in that file to the compiled list of parameters under the key <code class="docutils literal notranslate"><span class="pre">parallel</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-</span> <span class="pre">data:</span> <span class="pre">synthetic</span></code> means that Hydra will now look in the <code class="docutils literal notranslate"><span class="pre">data</span></code> subfolder for the <code class="docutils literal notranslate"><span class="pre">synthetic.yaml</span></code>
file and append all parameters in that file to the compiled list of parameters under the key <code class="docutils literal notranslate"><span class="pre">data</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-</span> <span class="pre">model:</span> <span class="pre">mLSTM120M</span></code> means that Hydra will now look in the <code class="docutils literal notranslate"><span class="pre">model</span></code> subfolder for the <code class="docutils literal notranslate"><span class="pre">mLSTM120M.yaml</span></code>
file and append all parameters in that file to the compiled list of parameters under the key <code class="docutils literal notranslate"><span class="pre">model</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_self_</span></code> means that all parameters in this file itself (that is, the <code class="docutils literal notranslate"><span class="pre">config.yaml</span></code>) will be inserted into the
compiled config.</p></li>
</ol>
<p>Note that all values that come later in the defaults list <strong>overwrite</strong> potential values that have been in the
configuration before.</p>
<p>Once Hydra has processed this file, it changes the current working directory as specified in the configs
and executes
<code class="docutils literal notranslate"><span class="pre">main_train(cfg)</span></code> in that directory, where <code class="docutils literal notranslate"><span class="pre">cfg</span></code> is the compiled configuration.
All top level parameters are in <code class="docutils literal notranslate"><span class="pre">cfg</span></code>, as for example, <code class="docutils literal notranslate"><span class="pre">cfg.device</span></code> and the
others are in their respective fields, for example, <code class="docutils literal notranslate"><span class="pre">cfg.parallel.data_axis_name</span></code>.</p>
<p>This is where Hydra stops. Everything coming after in the <code class="docutils literal notranslate"><span class="pre">main_train</span></code> function is instantiated manually for now.</p>
<section id="remarks">
<h3>Remarks<a class="headerlink" href="#remarks" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>It is possible to overwrite every parameter from the command line. So you can, for example, execute
<code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">scripts/training/train_with_hydra.py</span> <span class="pre">device=gpu</span> <span class="pre">model.num_heads=42</span></code>
to substitute <code class="docutils literal notranslate"><span class="pre">cpu</span></code>
from the <code class="docutils literal notranslate"><span class="pre">config.yaml</span></code> with <code class="docutils literal notranslate"><span class="pre">gpu</span></code> and to substitute 42 for whatever value for <code class="docutils literal notranslate"><span class="pre">num_heads</span></code> was given in <code class="docutils literal notranslate"><span class="pre">mLSTM120M.yaml</span></code> file. This is probably not the approach you want to use to start experiments though.</p></li>
</ul>
</section>
<section id="using-experiment-files">
<h3>Using Experiment Files<a class="headerlink" href="#using-experiment-files" title="Link to this heading">#</a></h3>
<p>(see https://hydra.cc/docs/patterns/configuring_experiments/)</p>
<p>A nicer since much more reproducible way to start experiments with Hydra is to use experiment files. In these files
you can specify all parameters and config groups that you want to change. Let us take the <code class="docutils literal notranslate"><span class="pre">experiment/train_mLSTM7B_slimpajama6b.yaml</span></code> as an example. That file reads</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># @package _global_</span>
<span class="nt">defaults</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">override /parallel</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mLSTM7B</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">override /model</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mLSTM7B</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">override /data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">slimpajama_6B_local_ds</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">override /optimizer</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">adamw</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">_self_</span>

<span class="c1"># specify the deltas from the defaults:</span>
<span class="nt">task_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mLSTM7B_slimpajama6b_example_experiment</span>
<span class="nt">batch_size_per_device</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8</span>
<span class="nt">context_length</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2048</span>
<span class="nt">num_epochs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1000</span>
<span class="nt">num_train_steps</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">95_000</span>
<span class="nt">lr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5e-4</span>

<span class="nt">trainer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">gradient_accumulate_steps</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
</pre></div>
</div>
<p>To use this file, you execute the following:</p>
<p><code class="docutils literal notranslate"><span class="pre">PYTHONPATH=.</span> <span class="pre">python</span> <span class="pre">scripts/training/train_with_hydra.py</span> <span class="pre">+experiment=train_mLSTM7B_slimpajama6b.yaml</span> </code></p>
<p>Note the + before experiment, that’s not a typo!
Hydra now checks the defaults list of the experiment file and replaces the respective fields from the general
<code class="docutils literal notranslate"><span class="pre">config.yaml</span></code>. That is, instead of looking for the <code class="docutils literal notranslate"><span class="pre">synthetic.yaml</span></code> in the data subfolder it now looks for the
<code class="docutils literal notranslate"><span class="pre">slimpajama_6B_local_ds.yaml</span></code> file and uses those paramters when compiling the configuration. In addition, you can
overwrite any parameter with your own values. This goes for all parameters at every level of the config hierarchy.
In this example, the value in <code class="docutils literal notranslate"><span class="pre">cfg.trainer.gradient_accumulation_steps</span></code>
is overwritten with 1.
By using experiment files, it becomes easy to specify and reproduce experiments.</p>
</section>
<section id="type-checking-of-the-configurations">
<h3>Type Checking of the Configurations<a class="headerlink" href="#type-checking-of-the-configurations" title="Link to this heading">#</a></h3>
<p>One benefit of using the structured configs and dataclasses as basis for the configuration is that type checking
becomes available. This happens when compiling the <code class="docutils literal notranslate"><span class="pre">cfg</span></code>. See also the structured configs section (TODO).</p>
<p>To test whether you have supplied correctly typed parameters in your experiment files, you can execute</p>
<p><code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">scripts/check_config.py</span> <span class="pre">+experiment={YOUR_EXPERIMENT_FILE}</span></code></p>
<p>This function just compiles and logs your compiled config. But it’s a good way to check if you have supplied a
working experiment file before starting a job on a cluster, for example.</p>
</section>
</section>
<section id="how-to-run-experiments-on-a-slurm-cluster">
<h2>How to run experiments on a SLURM cluster<a class="headerlink" href="#how-to-run-experiments-on-a-slurm-cluster" title="Link to this heading">#</a></h2>
<p>To run your script on a SLURM cluster you can use the <code class="docutils literal notranslate"><span class="pre">submitit_launcher</span></code>, which is installed for Hydra. The
default configuration is provided in <code class="docutils literal notranslate"><span class="pre">configs/hydra/launcher/slurm_launcher.yaml</span></code>:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># @package _global_</span>
<span class="nt">defaults</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">override /hydra/launcher</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">submitit_slurm</span>

<span class="nt">hydra</span><span class="p">:</span>
<span class="w">  </span><span class="nt">launcher</span><span class="p">:</span>
<span class="w">    </span><span class="nt">submitit_folder</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${hydra.sweep.dir}/.submitit/%j</span>
<span class="w">    </span><span class="nt">timeout_min</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">60</span>
<span class="w">    </span><span class="nt">cpus_per_task</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">28</span>
<span class="w">    </span><span class="nt">gpus_per_node</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8</span>
<span class="w">    </span><span class="nt">gres</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gpu:8</span>
<span class="w">    </span><span class="nt">tasks_per_node</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8</span>
<span class="w">    </span><span class="nt">mem_gb</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">~</span>
<span class="w">    </span><span class="nt">nodes</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${hydra.job.name}</span>
<span class="w">    </span><span class="nt">_target_</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">hydra_plugins.hydra_submitit_launcher.submitit_launcher.SlurmLauncher</span>
<span class="w">    </span><span class="nt">partition</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">compute</span>
<span class="w">    </span><span class="nt">qos</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">    </span><span class="nt">comment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">testing_slurmit_launcher</span>
<span class="w">    </span><span class="nt">additional_parameters</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span>
<span class="w">      </span><span class="s">&quot;gpu-bind&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;none&quot;</span><span class="p p-Indicator">,</span>
<span class="w">      </span><span class="s">&quot;wait-all-nodes&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span><span class="p p-Indicator">,</span>
<span class="w">      </span><span class="s">&quot;time&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;2-00:00:00&quot;</span><span class="p p-Indicator">,</span>
<span class="w">      </span><span class="s">&quot;exclusive&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p p-Indicator">,</span>
<span class="w">    </span><span class="p p-Indicator">}</span>
<span class="w">    </span><span class="nt">setup</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">export NCCL_CROSS_NIC=0</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">export NCCL_SOCKET_NTHREADS=16</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">export NCCL_DEBUG=WARN</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">export NCCL_CUMEM_ENABLE=0</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">export NCCL_IB_SPLIT_DATA_ON_QPS=0</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">export NCCL_IB_QPS_PER_CONNECTION=16</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">export NCCL_IB_GID_INDEX=3</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">export NCCL_IB_TC=41</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">export NCCL_IB_SL=0</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">export NCCL_IB_TIMEOUT=22</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">export NCCL_NET_PLUGIN=none</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">export NCCL_SOCKET_IFNAME=eth0</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">export NCCL_IGNORE_CPU_AFFINITY=1</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">export NCCL_IB_HCA=&quot;=mlx5_0,mlx5_1,mlx5_3,mlx5_4,mlx5_5,mlx5_6,mlx5_7,mlx5_8,mlx5_9,mlx5_10,mlx5_12,mlx5_13,mlx5_14,mlx5_15,mlx5_16,mlx5_17&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">export HCOLL_ENABLE_MCAST_ALL=0</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">export coll_hcoll_enable=0</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">export UCX_TLS=tcp</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">export UCX_NET_DEVICES=eth0</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">export RX_QUEUE_LEN=8192</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">export IB_RX_QUEUE_LEN=8192</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">export OMPI_MCA_coll=^hcoll</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/nfs-gpu/xlstm/miniforge3/envs/python_3.11_jax_0.4.34_cuda_12.6/cuda-compat</span>
</pre></div>
</div>
<p>Here, you can supply (or rather overwrite in an experment file!) the things you would normally put into a SLURM run
script. To use the <code class="docutils literal notranslate"><span class="pre">submitit_launcher</span></code> you have to execute the following with the conda env
activated that you want to use for the experiment:</p>
<p><code class="docutils literal notranslate"><span class="pre">PYTHONPATH=.</span> <span class="pre">python</span> <span class="pre">scripts/training/train_with_hydra.py</span> <span class="pre">--multirun</span> <span class="pre">hydra/launcher=slurm_launcher</span> <span class="pre">+experiment={YOUR_EXPERIMENT_FILE}</span></code></p>
<p>So the only thing you have to add is <code class="docutils literal notranslate"><span class="pre">--multirun</span> <span class="pre">hydra/launcher=slurm_launcher</span></code> (and to overwrite SLURM-specific parameters as the number of nodes, for example, in your experiment file).</p>
</section>
<section id="how-to-resume-an-experiment">
<h2>How to Resume an Experiment?<a class="headerlink" href="#how-to-resume-an-experiment" title="Link to this heading">#</a></h2>
<p>To resume an experiment you need to know the path to the output
folder of the experiment. You then execute</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">scripts</span><span class="o">/</span><span class="n">traininig</span><span class="o">/</span><span class="n">get_cli_command_to_resume_training</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">resume_from_folder</span><span class="o">=</span><span class="n">PATH_TO_RUN</span>
</pre></div>
</div>
<p>If you want to use SLURM, set the flag <code class="docutils literal notranslate"><span class="pre">--use_slurm</span></code>.
Not that this is only required if
the original run was executed with SLURM by way of the CLI override
<code class="docutils literal notranslate"><span class="pre">--multirun</span> <span class="pre">hydra/launcher=slurm_launcher</span></code> and
not by way of experiment file. If it was specified in the experiment file, SLURM is used anyway.</p>
<p>If you want to use the latest checkpoint, you don’t need to supply anything but if you want to use a
specific checkpoint, use <code class="docutils literal notranslate"><span class="pre">--checkpoint_step=X</span></code> to use checkpoint X.</p>
<p>New hydra overrides can be supplied by way of <code class="docutils literal notranslate"><span class="pre">--new_overrides=STRING_OF_OVERRIDES</span></code>.
Example of such a string for more training steps, a different learning rate and
a different logging frequency would be
<code class="docutils literal notranslate"><span class="pre">--new_overrides=&quot;num_train_steps=20000</span> <span class="pre">lr=0.0001</span> <span class="pre">logger.log_every_n_steps=10&quot;</span></code>, that is,
the format is exactly as you would supply for CLI overrides.</p>
<p>Executing <code class="docutils literal notranslate"><span class="pre">get_cli_command_to_resume_training</span></code> will return a string of the command that you
have to execute to continue the training run.</p>
<p>A full example to call is</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">scripts</span><span class="o">/</span><span class="n">training</span><span class="o">/</span><span class="n">get_cli_command_to_resume_training</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">resume_from_folder</span><span class="o">=</span><span class="n">PATH_TO_RUN</span> <span class="o">--</span><span class="n">use_slurm</span> <span class="o">--</span><span class="n">checkpoint_step</span><span class="o">=</span><span class="mi">95000</span> <span class="o">--</span><span class="n">new_overrides</span><span class="o">=</span><span class="s2">&quot;num_train_steps=20000 lr=0.0001 logger.log_every_n_steps=10&quot;</span>
</pre></div>
</div>
<p>What the script does is to look in the specified folder and obtain the overrides (including the experiment file)
that were used to start the previous run. It then compiles a new command from these, which, for the current
example would look something like this:</p>
<p><code class="docutils literal notranslate"><span class="pre">PYTHONPATH=.</span> <span class="pre">python</span> <span class="pre">scripts/training/resume_training_with_hydra.py</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">-m</span> <span class="pre">hydra/launcher=slurm_launcher</span> <span class="pre">+experiment=synthetic_experiment_slurm</span> <span class="pre">+resume_from_folder=PATH_TO_RUN</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">+checkpoint_step=95000</span> <span class="pre">num_train_steps=20000</span> <span class="pre">lr=0.0001</span> <span class="pre">logger.log_every_n_steps=10</span></code></p>
<p>This is the actual command you have to run to resume the experiment. Keep in mind that you can still
use any other CLI overrides at this point so using them in the previous step is not strictly necessary.</p>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="example_training.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Training large language models in xlstm-jax</p>
      </div>
    </a>
    <a class="right-next"
       href="distributed_training.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Distributed Training</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#configuration-structure">Configuration Structure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-run-experiments">How to Run Experiments</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#remarks">Remarks</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-experiment-files">Using Experiment Files</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#type-checking-of-the-configurations">Type Checking of the Configurations</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-run-experiments-on-a-slurm-cluster">How to run experiments on a SLURM cluster</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-resume-an-experiment">How to Resume an Experiment?</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By NXAI GmbH
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024, NXAI GmbH.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>